---
import content from '../data/content.json';

const { skills } = content;
---

<section id="skills" class="py-20 px-4 overflow-hidden relative z-10">
  <div class="max-w-6xl mx-auto mb-12">
    <h2 class="text-5xl md:text-6xl font-bold text-center mb-4 text-gradient animate-gradient">
      {skills.title}
    </h2>
    <div class="w-20 h-1 bg-gradient-to-r from-cyan-400 to-blue-500 mx-auto rounded-full"></div>
  </div>

  <div class="relative">
    <!-- Marquee container -->
    <div class="marquee-container">
      <div class="marquee-content" id="marquee-content">
        {/* 第一组 */}
        {skills.items.map((skill) => (
          <div class="marquee-item glass rounded-full px-8 py-4 mx-3 hover:glow-effect transition-all duration-300 hover:scale-110 group">
            <span class="text-xl font-medium text-gray-200 group-hover:text-gradient group-hover:animate-gradient whitespace-nowrap transition-all duration-300">
              {skill}
            </span>
          </div>
        ))}
        {/* 第二组 - 无缝循环 */}
        {skills.items.map((skill) => (
          <div class="marquee-item glass rounded-full px-8 py-4 mx-3 hover:glow-effect transition-all duration-300 hover:scale-110 group">
            <span class="text-xl font-medium text-gray-200 group-hover:text-gradient group-hover:animate-gradient whitespace-nowrap transition-all duration-300">
              {skill}
            </span>
          </div>
        ))}
        {/* 第三组 - 防止穿帮 */}
        {skills.items.map((skill) => (
          <div class="marquee-item glass rounded-full px-8 py-4 mx-3 hover:glow-effect transition-all duration-300 hover:scale-110 group">
            <span class="text-xl font-medium text-gray-200 group-hover:text-gradient group-hover:animate-gradient whitespace-nowrap transition-all duration-300">
              {skill}
            </span>
          </div>
        ))}
      </div>
    </div>
  </div>
</section>

<script>
  // 确保动画从正确的位置开始
  document.addEventListener('DOMContentLoaded', () => {
    const marqueeContent = document.getElementById('marquee-content');
    if (marqueeContent) {
      // 强制重新启动动画，确保无缝循环
      marqueeContent.style.animation = 'none';
      setTimeout(() => {
        marqueeContent.style.animation = '';
      }, 10);
    }
  });
</script>

<style>
  .marquee-container {
    position: relative;
    width: 100%;
    overflow: hidden;
    padding: 20px 0;
    mask-image: linear-gradient(
      to right,
      transparent,
      black 10%,
      black 90%,
      transparent
    );
    -webkit-mask-image: linear-gradient(
      to right,
      transparent,
      black 10%,
      black 90%,
      transparent
    );
  }

  .marquee-content {
    display: flex;
    animation: marquee 30s linear infinite;
    width: fit-content;
    will-change: transform;
  }

  .marquee-content:hover {
    animation-play-state: paused;
  }

  .marquee-item {
    flex-shrink: 0;
  }

  @keyframes marquee {
    from {
      transform: translateX(0);
    }
    to {
      transform: translateX(-33.333%);
    }
  }

  @media (max-width: 768px) {
    .marquee-content {
      animation-duration: 20s;
    }
  }

  /* 确保在页面加载时动画已经开始 */
  @media (prefers-reduced-motion: no-preference) {
    .marquee-content {
      animation-play-state: running;
    }
  }

  /* 减少动态效果以提升性能 */
  @media (prefers-reduced-motion: reduce) {
    .marquee-content {
      animation: none;
    }
  }
</style>
